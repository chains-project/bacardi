20d19
< import com.google.cloud.pubsublite.PublishMetadata;
27a27
> import com.google.cloud.pubsublite.internal.wire.PartitionPublisherFactory; // Added import for PartitionPublisherFactory
49,50c49,52
<         partition ->
<             SinglePartitionPublisherBuilder.newBuilder()
---
>         new PartitionPublisherFactory() { // Changed to use the correct functional interface
>             @Override
>             public Publisher<PublishMetadata> create(int partition) {
>                 return SinglePartitionPublisherBuilder.newBuilder()
54c56,58
<                 .build());
---
>                     .build();
>             }
>         });
