70c70,71
<                         if (tree.size() == 0 || tree.query1NN(coords).dist() > distanceTolerance) {
---
>                         // Update: use nearestNeighbour(coords).distance instead of query1NN(coords).dist()
>                         if (tree.size() == 0 || tree.nearestNeighbour(coords).distance > distanceTolerance) {
