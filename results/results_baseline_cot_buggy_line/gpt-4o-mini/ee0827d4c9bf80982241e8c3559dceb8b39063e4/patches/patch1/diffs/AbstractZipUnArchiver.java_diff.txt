28d27
< import org.apache.commons.io.input.BoundedInputStream;
204,206c203,215
<                         BoundedInputStream bis = new BoundedInputStream( in, remainingSpace + 1 );
<                         CountingInputStream cis = new CountingInputStream( bis );
<                         extractFile( getSourceFile(), outputDirectory, cis,
---
>                         // BoundedInputStream has been removed, using a different approach
>                         CountingInputStream cis = new CountingInputStream( in );
>                         long bytesToRead = Math.min( remainingSpace, ze.getSize() );
>                         byte[] buffer = new byte[8192];
>                         long totalRead = 0;
>                         int bytesRead;
>                         while ((bytesRead = cis.read(buffer, 0, (int)Math.min(buffer.length, bytesToRead - totalRead))) != -1) {
>                             totalRead += bytesRead;
>                             if (totalRead >= bytesToRead) {
>                                 break;
>                             }
>                         }
>                         extractFile( getSourceFile(), outputDirectory, new CountingInputStream(in),
211c220
<                         remainingSpace -= cis.getByteCount();
---
>                         remainingSpace -= totalRead;
