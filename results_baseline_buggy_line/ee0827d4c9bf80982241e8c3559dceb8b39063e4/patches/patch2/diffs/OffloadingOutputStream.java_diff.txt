19a20
> import java.io.ByteArrayOutputStream; // Added import for ByteArrayOutputStream
27c28
< import org.apache.commons.io.output.ThresholdingOutputStream;
---
> import org.apache.commons.io.output.ThresholdingOutputStream; // Ensure this class is available in the updated dependency
30c31
<  * Offloads to disk when a given memory consumption has been reacehd
---
>  * Offloads to disk when a given memory consumption has been reached
38c39
<      * The output stream to which data will be written prior to the theshold
---
>      * The output stream to which data will be written prior to the threshold
137c138
<      * that is backed by disk. This is the point at which we realise that too
---
>      * that is backed by disk. This is the point at which we realize that too
155,158c156,157
< 
<         InputStream memoryAsInput = memoryOutputStream.toInputStream();
<         if ( outputFile == null )
<         {
---
>         InputStream memoryAsInput = new SequenceInputStream(new ByteArrayInputStream(memoryOutputStream.toByteArray()), 
>                                                              outputFile != null ? Files.newInputStream(outputFile.toPath()) : null);
161,162d159
<         return new SequenceInputStream( memoryAsInput, Files.newInputStream( outputFile.toPath() ) );
<     }
