45c45,47
<             if (tree.size() == 0 || tree.query1NN(coords) == null || tree.query1NN(coords).dist() > distanceTolerance) {
---
>             // Updated the query from query1NN to queryNearest
>             if (tree.size() == 0 || tree.queryNearest(coords, 1).isEmpty() || 
>                 tree.queryNearest(coords, 1).get(0).dist() > distanceTolerance) {
